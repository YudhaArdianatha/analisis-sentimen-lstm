<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
    <title>Analisis Sentimen LSTM</title>
    <style>
      :root {
        --primary-color: #2563eb;
        --secondary-color: #64748b;
        --success-color: #16a34a;
        --warning-color: #d97706;
        --danger-color: #dc2626;
        --dark-color: #1e293b;
        --light-color: #f8fafc;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background-color: var(--light-color);
      }

      .bg-image {
        position: relative;
        background-image: url("/static/images/bg-index.jpg");
        background-size: cover;
        background-position: center;
        z-index: 1;
        color: white;
        height: 80vh;
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 500px;
      }

      .bg-image::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        z-index: -1;
      }

      .hero-content {
        text-align: center;
        z-index: 2;
        animation: fadeInUp 1s ease-out;
        padding: 0 15px;
        max-width: 100%;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .section-title {
        color: var(--dark-color);
        font-weight: 700;
        margin-bottom: 2rem;
        position: relative;
        display: inline-block;
      }

      .section-title::after {
        content: "";
        position: absolute;
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        width: 60px;
        height: 3px;
        background: linear-gradient(90deg, var(--primary-color), var(--success-color));
        border-radius: 2px;
      }

      .input-section {
        background: white;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        padding: 2.5rem;
        margin: 2rem 0;
        border: 1px solid #e2e8f0;
      }

      .input-method-btn {
        border: 2px solid var(--primary-color);
        color: var(--primary-color);
        background: transparent;
        border-radius: 12px;
        padding: 12px 24px;
        font-weight: 600;
        transition: all 0.3s ease;
        margin: 8px;
        position: relative;
        overflow: hidden;
        white-space: nowrap;
        min-width: 120px;
      }

      .input-method-btn:hover {
        background: var(--primary-color);
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(37, 99, 235, 0.3);
      }

      .input-method-btn.active {
        background: var(--primary-color);
        color: white;
        box-shadow: 0 4px 15px rgba(37, 99, 235, 0.4);
      }

      .input-group > .form-control {
        width: 85% !important; /* atau width yang kamu inginkan, misal: 100%, 300px, dll */
        flex: none !important; /* nonaktifkan fleksibilitas */
      }

      .form-control {
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        padding: 14px 18px;
        font-size: 16px;
        transition: all 0.3s ease;
        background: #f8fafc;
      }

      .form-control:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        background: white;
      }

      .btn-submit {
        background: linear-gradient(135deg, var(--primary-color), #3b82f6);
        border: none;
        color: white;
        padding: 14px 28px;
        border-radius: 12px;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
      }

      .btn-submit:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(37, 99, 235, 0.4);
        background: linear-gradient(135deg, #1d4ed8, var(--primary-color));
      }

      .results-section {
        background: white;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        padding: 2.5rem;
        margin: 2rem 0;
        border: 1px solid #e2e8f0;
      }

      .sentiment-card {
        background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
        border: 1px solid #0284c7;
        border-radius: 16px;
        padding: 2rem;
        margin: 1rem 0;
        text-align: center;
      }

      .chart-container {
        background: white;
        border-radius: 16px;
        padding: 1.5rem;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        margin: 1rem 0;
        position: relative;
        height: 300px;
      }

      .wc-img {
        max-width: 100%;
        height: auto;
        border-radius: 16px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      }

      .info-text {
        color: var(--secondary-color);
        font-size: 14px;
        margin-top: 1rem;
        padding: 1rem;
        background: #f1f5f9;
        border-radius: 12px;
        border-left: 4px solid var(--primary-color);
      }

      .conclusion-section {
        background: linear-gradient(135deg, #f8fafc, #e2e8f0);
        border-radius: 16px;
        padding: 2rem;
        margin: 2rem 0;
        border: 1px solid #cbd5e1;
      }

      .download-btn {
        background: linear-gradient(135deg, var(--success-color), #22c55e);
        border: none;
        color: white;
        padding: 12px 24px;
        border-radius: 12px;
        font-weight: 600;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-block;
      }

      .download-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(22, 163, 74, 0.3);
        color: white;
      }

      .guide-section {
        background: white;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        padding: 2.5rem;
        margin: 2rem 0;
        border: 1px solid #e2e8f0;
      }

      .guide-section img {
        border-radius: 16px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
        max-width: 100%;
        height: auto;
      }

      .guide-section img:hover {
        transform: scale(1.02);
      }

      footer {
        background: linear-gradient(135deg, var(--dark-color), #334155);
        color: white;
        padding: 2rem 0;
        margin-top: 3rem;
      }

      .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.9);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        backdrop-filter: blur(5px);
      }

      .spinner-border {
        width: 3rem;
        height: 3rem;
      }

      .alert {
        border-radius: 12px;
        border: none;
        box-shadow: 0 4px 15px rgba(220, 38, 38, 0.2);
      }

      .input-form {
        display: none;
        margin-top: 1.5rem;
      }

      .input-form.active {
        display: block;
      }

      /* Responsive Design */
      @media (max-width: 1200px) {
        .input-section {
          padding: 2rem;
        }

        .results-section {
          padding: 2rem;
        }

        .guide-section {
          padding: 2rem;
        }
      }

      @media (max-width: 992px) {
        .bg-image {
          height: 70vh;
          min-height: 400px;
        }

        .hero-content h1 {
          font-size: 2.5rem;
        }

        .hero-content p {
          font-size: 1.1rem;
        }

        .input-method-btn {
          margin: 5px;
          min-width: 100px;
          padding: 10px 20px;
        }

        .chart-container {
          height: 250px;
        }
      }

      @media (max-width: 768px) {
        .bg-image {
          height: 60vh;
          min-height: 350px;
        }

        .hero-content h1 {
          font-size: 2rem;
        }

        .hero-content p {
          font-size: 1rem;
          padding: 0 10px;
        }

        .input-section {
          padding: 1.5rem;
          margin: 1rem;
          border-radius: 15px;
        }

        .results-section {
          padding: 1.5rem;
          margin: 1rem;
          border-radius: 15px;
        }

        .guide-section {
          padding: 1.5rem;
          margin: 1rem;
          border-radius: 15px;
        }

        .input-method-btn {
          width: 100%;
          margin: 5px 0;
          min-width: auto;
        }

        .input-group {
          flex-direction: column;
        }

        .input-group .form-control {
          border-radius: 12px;
          margin-bottom: 10px;
        }

        .input-group .btn {
          border-radius: 12px;
          width: 100%;
        }

        .section-title {
          font-size: 1.5rem;
        }

        .chart-container {
          height: 200px;
          padding: 1rem;
        }

        .sentiment-card {
          padding: 1.5rem;
        }

        footer {
          padding: 1.5rem 0;
        }

        footer .row {
          text-align: center;
        }

        footer .col-md-6 {
          margin-bottom: 1rem;
        }
      }

      @media (max-width: 576px) {
        .bg-image {
          height: 50vh;
          min-height: 300px;
        }

        .hero-content h1 {
          font-size: 1.8rem;
        }

        .hero-content p {
          font-size: 0.9rem;
        }

        .hero-content .btn {
          font-size: 0.9rem;
          padding: 10px 20px;
        }

        .input-section {
          padding: 1rem;
          margin: 0.5rem;
        }

        .results-section {
          padding: 1rem;
          margin: 0.5rem;
        }

        .guide-section {
          padding: 1rem;
          margin: 0.5rem;
        }

        .section-title {
          font-size: 1.3rem;
        }

        .form-control {
          padding: 12px 16px;
          font-size: 14px;
        }

        .btn {
          padding: 12px 20px;
          font-size: 14px;
        }

        .info-text {
          font-size: 12px;
          padding: 0.8rem;
        }

        .chart-container {
          height: 180px;
          padding: 0.8rem;
        }

        .sentiment-card {
          padding: 1rem;
        }

        .loading-overlay p {
          font-size: 14px;
        }
      }

      @media (max-width: 480px) {
        .hero-content h1 {
          font-size: 1.5rem;
        }

        .hero-content p {
          font-size: 0.8rem;
        }

        .section-title {
          font-size: 1.2rem;
        }

        .input-section {
          border-radius: 10px;
        }

        .results-section {
          border-radius: 10px;
        }

        .guide-section {
          border-radius: 10px;
        }

        .form-control {
          border-radius: 8px;
        }

        .btn {
          border-radius: 8px;
        }

        .input-method-btn {
          border-radius: 8px;
          font-size: 13px;
        }
        .input-group > .form-control {
          width: 100% !important; /* atau width yang kamu inginkan, misal: 100%, 300px, dll */
          flex: none !important; /* nonaktifkan fleksibilitas */
          border-radius: 0;
        }
        .input-group .btn {
          border-radius: 0 !important;
        }
      }

      /* Chart responsive adjustments */
      @media (max-width: 768px) {
        .chart-canvas {
          max-height: 200px;
        }
        .input-group > .form-control {
          width: 100% !important; /* atau width yang kamu inginkan, misal: 100%, 300px, dll */
          flex: none !important; /* nonaktifkan fleksibilitas */
          border-radius: 0;
        }
        .input-group .btn {
          border-radius: 0 !important;
        }
      }

      /* Ensure images are always responsive */
      img {
        max-width: 100%;
        height: auto;
      }

      /* Button group responsive */
      .btn-group-mobile {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      @media (min-width: 769px) {
        .btn-group-mobile {
          flex-direction: row;
          justify-content: center;
          gap: 0;
        }
      }

      /* Tambahan responsif */
      @media (max-width: 768px) {
        .input-group {
          flex-direction: column;
          align-items: stretch;
        }

        .input-group .form-control {
          width: 100% !important;
          margin-bottom: 10px;
          border-radius: 12px !important;
        }

        .input-group .btn {
          width: 100%;
          border-radius: 12px !important;
        }

        .btn-group-mobile {
          flex-direction: column;
          gap: 10px;
        }

        .chart-container,
        .wc-img {
          margin-top: 1rem;
        }
      }

      @media (max-width: 480px) {
        .hero-content h1 {
          font-size: 1.6rem;
        }

        .hero-content p {
          font-size: 0.9rem;
        }

        .btn {
          font-size: 0.85rem;
          padding: 10px 16px;
        }

        .form-control {
          font-size: 0.9rem;
          padding: 10px 14px;
        }

        .chart-container {
          height: 180px;
        }
      }
    </style>
  </head>
  <body>
    <div class="bg-image">
      <div class="hero-content">
        <h1 class="display-4 fw-bold mb-4"><i class="fas fa-brain me-3"></i>Analisis Sentimen</h1>
        <p class="lead mb-4 px-3 col-md-8 mx-auto">
          Analisis sentimen adalah proses memahami dan mengelompokkan emosi dalam teks untuk mengungkap opini positif, negatif, atau netral, sehingga membantu bisnis dan peneliti memahami pandangan pengguna secara mendalam.
        </p>
        <button type="button" class="btn btn-light btn-lg px-4 rounded-pill shadow-lg" onclick="document.querySelector('.input-section').scrollIntoView({behavior: 'smooth'})"><i class="fas fa-rocket me-2"></i>Mulai Analisis</button>
      </div>
    </div>

    <div class="container-fluid px-3 px-md-4">
      <div class="input-section">
        <div class="text-center mb-4">
          <h2 class="section-title"><i class="fas fa-keyboard me-2"></i>Input Sentimen</h2>
          <p class="text-muted">Input dapat berupa ulasan, file excel, atau kode dari aplikasi</p>
        </div>

        <!-- Error Message Section -->
        {% if error_message %}
        <div class="row justify-content-center text-center mt-3">
          <div class="col-lg-6 col-md-8 col-12">
            <div class="alert alert-danger" style="display: none" id="errorAlert">{{ error_message }}</div>
          </div>
        </div>
        {% endif %}

        <!-- Input Method Buttons -->
        <div class="row justify-content-center align-items-center text-center m-3">
          <div class="col-12">
            <div class="btn-group-mobile">
              <button class="input-method-btn {% if not percentages or (sentiment and not percentages) %}active{% endif %}" id="btnSentiment">Ulasan</button>
              <button class="input-method-btn {% if percentages and not sentiment and not app_code_analysis %}active{% endif %}" id="btnFile">File Excel</button>
              <button class="input-method-btn {% if percentages and app_code_analysis %}active{% endif %}" id="btnKode">Kode Aplikasi</button>
            </div>
          </div>
        </div>

        <!-- Input Forms -->
        <div class="row justify-content-center">
          <div class="col-lg-8 col-md-10 col-12">
            <!-- Text Input Form -->
            <form id="textForm" action="/analyze_text" method="POST" class="input-form {% if not percentages or (sentiment and not percentages) %}active{% endif %}">
              <div class="mb-3">
                <label for="textInput" class="form-label">Masukkan Ulasan:</label>
                <div class="input-group">
                  <input
                    type="text"
                    class="form-control"
                    id="textInput"
                    name="text"
                    placeholder="Contoh: Aplikasi ini sangat bagus dan mudah digunakan!"
                    required
                    autocomplete="off"
                    value="{% if sentiment and text %}{{ text }}{% endif %}"
                  />
                  <button class="btn btn-outline-secondary d-md-block" type="submit"><i class="fas fa-paper-plane me-1"></i>Submit</button>
                </div>
                <div id="textError" class="text-danger mt-2" style="display: none">Harap masukkan ulasan terlebih dahulu.</div>
              </div>
            </form>

            <!-- File Upload Form -->
            <form id="fileForm" action="/analyze_csv" method="POST" enctype="multipart/form-data" class="input-form {% if percentages and not sentiment and not app_code_analysis %}active{% endif %}">
              <div class="mb-3">
                <label for="fileInput" class="form-label">Upload File Excel:</label>
                <div class="input-group">
                  <input type="file" class="form-control" id="fileInput" name="file" accept=".xlsx, .xls" required />
                  <button class="btn btn-outline-secondary d-md-block" type="submit"><i class="fas fa-upload me-1"></i>Upload</button>
                </div>
                <div id="fileError" class="text-danger mt-2" style="display: none">Harap unggah file terlebih dahulu.</div>
                <div class="info-text mt-3">
                  <p class="mb-1"><strong>Catatan Penting:</strong></p>
                  <p class="mb-1">• Semakin banyak data, semakin lama prosesnya</p>
                  <p class="mb-0">• Kolom ulasan harus bernama 'content' (tanpa tanda petik)</p>
                </div>
              </div>
            </form>

            <!-- App Code Form -->
            <form id="appForm" action="/analyze_appcode" method="POST" class="input-form {% if percentages and app_code_analysis %}active{% endif %}">
              <div class="mb-3">
                <label for="appCodeInput" class="form-label">Masukkan Kode Aplikasi:</label>
                <div class="input-group">
                  <input type="text" class="form-control" id="appCodeInput" name="app_code" placeholder="Contoh: com.example.myapp" required autocomplete="off" value="{% if app_code_analysis and app_code %}{{ app_code }}{% endif %}" />
                  <button class="btn btn-outline-secondary d-md-block" type="submit"><i class="fas fa-search me-1"></i>Analisis</button>
                </div>
                <div id="appCodeError" class="text-danger mt-2" style="display: none">Harap masukkan kode aplikasi terlebih dahulu.</div>
                <div class="info-text mt-3">
                  <p class="mb-1"><strong>Cara mencari kode aplikasi:</strong></p>
                  <p class="mb-0">Lihat panduan di bawah untuk menemukan kode aplikasi di Google Play Store</p>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Results Section -->
      {% if sentiment or percentages %}
      <div class="results-section" id="resultsSection" style="display: none">
        <div class="row mt-5 p-3">
          <div class="col-12 text-center">
            <h2>Hasil Analisis Sentimen</h2>
          </div>

          {% if sentiment %}
          <div class="text-center mt-3">
            <h4>Ulasan: <span id="analyzedText">{{ text }}</span></h4>
            <h4>Prediksi sentimen: <span id="sentimentResult">{{ sentiment }}</span></h4>
            <h5>Confidence Score: <span id="confidenceScore">{{ confidence_score | round(4) }}</span></h5>
          </div>
          {% endif %} {% if percentages %}
          <div class="row justify-content-center align-items-center mt-4">
            <div class="col-12 col-md-6 mb-3">
              <div class="chart-container">
                <canvas id="sentimentChart" class="chart-canvas"></canvas>
              </div>
            </div>
            <div class="col-12 col-md-6">
              {% if wordcloud_path %}
              <img src="/{{ wordcloud_path }}" alt="Word Cloud" class="wc-img" />
              {% else %}
              <div class="text-center">
                <div class="bg-light rounded p-4">
                  <i class="fas fa-cloud text-primary" style="font-size: 3rem"></i>
                  <p class="mt-2">Word Cloud akan muncul di sini</p>
                </div>
              </div>
              {% endif %}
            </div>
          </div>

          {% if average_confidence %}
          <div class="text-center mt-3">
            <h5>Rata-rata Confidence Score: {{ average_confidence }}</h5>
          </div>
          {% endif %}

          <script>
            var ctx = document.getElementById("sentimentChart").getContext("2d");
            var sentimentData = {{ [percentages['positif'], percentages['negatif'], percentages['netral']] | tojson }};
            var sentimentChart = new Chart(ctx, {
              type: 'pie',
              data: {
                labels: ['Positif', 'Negatif', 'Netral'],
                datasets: [{
                  label: 'Persentase Sentimen',
                  data: sentimentData,
                  backgroundColor: ['#4CAF50', '#F44336', '#FFC107']
                }]
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                height: 300
              }
            });
          </script>

          <div class="row mt-4">
            <div class="col-lg-10 col-md-9 col-8">
              <h4>Kesimpulan</h4>
            </div>
            <div class="col-lg-2 col-md-3 col-4 text-end">
              {% if download_link %}
              <a href="/download/{{ download_link }}"
                ><button class="btn btn-primary"><i class="fas fa-download me-1"></i>Download</button></a
              >
              {% else %}
              <button class="btn btn-primary"><i class="fas fa-download me-1"></i>Download</button>
              {% endif %}
            </div>
          </div>

          <div class="mt-3">
            <h5>
              {% if jumlah_data %} Dari total {{ jumlah_data }} ulasan yang diambil dari {% if app_code %} aplikasi dengan kode <strong>{{ app_code }}</strong> {% elif filename %} file <strong>{{ filename }}</strong>
              {% else %} sumber tidak dikenal {% endif %}, {{ percentages['positif'] }}% positif, {{ percentages['negatif'] }}% negatif, dan {{ percentages['netral'] }}% netral. Gunakan data ini sebaik mungkin untuk memahami persepsi
              pengguna dan meningkatkan kualitas layanan secara menyeluruh. Temuan ini dapat membantu dalam mengidentifikasi keunggulan serta area yang masih perlu diperbaiki. Dengan analisis yang tepat, data ini dapat menjadi dasar
              pengambilan keputusan yang lebih terarah dan berkelanjutan. {% else %} Analisis sentimen telah selesai. Gunakan hasil ini untuk memahami persepsi pengguna dan meningkatkan kualitas layanan secara menyeluruh. Temuan ini dapat
              membantu dalam mengidentifikasi keunggulan serta area yang masih perlu diperbaiki. {% endif %}
            </h5>
          </div>
          {% endif %}
        </div>
      </div>
      {% endif %}

      <!-- Guide Section -->
      <div class="guide-section">
        <div class="text-center mb-4">
          <h2 class="section-title"><i class="fas fa-question-circle me-2"></i>Tahapan Mencari Kode Aplikasi</h2>
        </div>
        <div class="text-center">
          <img class="img-fluid" src="/static/images/find-code.png" alt="find_code" />
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer>
      <div class="container-fluid px-3 px-md-4">
        <div class="row align-items-center">
          <div class="col-md-6 text-center text-md-start mb-2 mb-md-0">
            <p class="mb-0"><i class="fas fa-copyright me-2"></i>2025 <strong>Sentiment Analyzer</strong></p>
          </div>
          <div class="col-md-6 text-center text-md-end">
            <small> <i class="fas fa-user me-1"></i>by: <strong>Sang Made Yudha Ardianatha</strong> | <i class="fas fa-phone me-1"></i>0813-3866-5572 </small>
          </div>
        </div>
      </div>
    </footer>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none">
      <div class="text-center">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-3 text-muted">Sedang memproses analisis...</p>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>

    <script>
      // DOM Elements
      const btnSentiment = document.getElementById("btnSentiment");
      const btnFile = document.getElementById("btnFile");
      const btnKode = document.getElementById("btnKode");

      const textForm = document.getElementById("textForm");
      const fileForm = document.getElementById("fileForm");
      const appForm = document.getElementById("appForm");

      const buttons = [btnSentiment, btnFile, btnKode];
      const forms = [textForm, fileForm, appForm];

      // Event Listeners for input method buttons
      btnSentiment.addEventListener("click", function () {
        showInput("sentiment");
        saveLastInput("sentiment");
      });

      btnFile.addEventListener("click", function () {
        showInput("file");
        saveLastInput("file");
      });

      btnKode.addEventListener("click", function () {
        showInput("kode");
        saveLastInput("kode");
      });

      // Show Input Function
      function showInput(type) {
        // Remove active class from all buttons and forms
        buttons.forEach((btn) => btn.classList.remove("active"));
        forms.forEach((form) => form.classList.remove("active"));

        // Show selected input and activate button
        if (type === "sentiment") {
          textForm.classList.add("active");
          btnSentiment.classList.add("active");
        } else if (type === "file") {
          fileForm.classList.add("active");
          btnFile.classList.add("active");
        } else if (type === "kode") {
          appForm.classList.add("active");
          btnKode.classList.add("active");
        }
      }

      // Save and load last input preference (using in-memory variable)
      let lastInputType = "sentiment";

      function saveLastInput(type) {
        lastInputType = type;
      }

      function getLastInput() {
        return lastInputType;
      }

      // Initialize based on server response or default
      function initializeFormState() {
        showInput("sentiment");
      }

      // Initialize with correct form state
      initializeFormState();

      // Form Validation and Loading
      document.getElementById("textForm").addEventListener("submit", function (e) {
        const input = this.querySelector('input[name="text"]');
        const errorDiv = document.getElementById("textError");

        if (!input.value.trim()) {
          e.preventDefault();
          input.classList.add("is-invalid");
          errorDiv.style.display = "block";
        } else {
          errorDiv.style.display = "none";
          showLoading();
        }
      });

      // Remove validation classes on input
      document.querySelectorAll("input").forEach((input) => {
        input.addEventListener("input", function () {
          this.classList.remove("is-invalid");
          // Hide error messages
          const errorDivs = document.querySelectorAll(".text-danger");
          errorDivs.forEach((div) => (div.style.display = "none"));
        });
      });

      // Show/Hide Loading Functions
      function showLoading() {
        document.getElementById("loadingOverlay").style.display = "flex";
      }

      function hideLoading() {
        document.getElementById("loadingOverlay").style.display = "none";
      }
      document.addEventListener("DOMContentLoaded", function () {
        console.log("Sentiment Analyzer initialized successfully!");

        // Show demo results for demonstration
        setTimeout(() => {
          document.getElementById("resultsSection").style.display = "block";
          initChart();
        }, 1000);
      });
    </script>
  </body>
</html>
